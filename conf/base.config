process {
    // Default process values
    time = 1.h
    memory = 1.Gb
    cpus = 1

    // Error strategy
    errorStategy = { task.exitStatus in [143,137,104,134,139] ? 'retry' : 'terminate' }
    maxRetries = 3
    maxErrors = '-1'

    /*
    Parallel: High cores, lower memory
    */
    
    withLabel: 'parallel_low' {
        time = { check_resources( 2.h * task.attempt, params.max_time) }
        memory = { check_resources(2.Gb * task.attempt, params.max_memory) }
        cpus = { check_resources(8 * task.attempt, params.max_cpus) }
    }

    withLabel: 'parallel_med' {
        time = { check_resources( 16.h * task.attempt, params.max_time) }
        memory = { check_resources(8.Gb * task.attempt, params.max_memory) }
        cpus = { check_resources(16 * task.attempt, params.max_cpus) }
    }

    withLabel: 'parallel_high' {
        time = { check_resources( 48.h * task.attempt, params.max_time) }
        memory = { check_resources(16.Gb * task.attempt, params.max_memory) }
        cpus = { check_resources(30 * task.attempt, params.max_cpus) }
    }

    /*
    Resource: Balanced cores + memory + time
    */

    withLabel: 'resource_low' {
        time = { check_resources( 1.h * task.attempt, params.max_time) }
        memory = { check_resources(4.Gb * task.attempt, params.max_memory) }
        cpus = { check_resources(1 * task.attempt, params.max_cpus) }
    }

    withLabel: 'resource_med' {
        time = { check_resources( 16.h * task.attempt, params.max_time) }
        memory = { check_resources(32.Gb * task.attempt, params.max_memory) }
        cpus = { check_resources(16 * task.attempt, params.max_cpus) }
    }

    withLabel: 'resource_high' {
        time = { check_resources( 24.h * task.attempt, params.max_time) }
        memory = { check_resources(64.Gb * task.attempt, params.max_memory) }
        cpus = { check_resources(30 * task.attempt, params.max_cpus) }
    }

    /*
    Resource: High memory
    */

    withLabel: 'highmem_low_smallClock' {
        time = { check_resources( 2.h * task.attempt, params.max_time) }
        memory = { check_resources(4.Gb * task.attempt, params.max_memory) }
        cpus = { check_resources(1 * task.attempt, params.max_cpus) }
    }

    withLabel: 'highmem_med' {
        time = { check_resources( 16.h * task.attempt, params.max_time) }
        memory = { check_resources(32.Gb * task.attempt, params.max_memory) }
        cpus = { check_resources(16 * task.attempt, params.max_cpus) }
    }

    withLabel: 'highmem_high' {
        time = { check_resources( 24.h * task.attempt, params.max_time) }
        memory = { check_resources(64.Gb * task.attempt, params.max_memory) }
        cpus = { check_resources(30 * task.attempt, params.max_cpus) }
    }

}