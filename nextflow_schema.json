{
  "version": "0.0.1",
  "title": "NF-PIPELINES",
  "description": [
    "This repository houses a collection of workflows I have developed over the",
    "course of my PhD. They are typically related to analyses that I needed to carry",
    "out at some point or another. Feel free to try them out, adapt them or even use",
    "them as a guide for your own custom pipelines."
  ],
  "definitions": {
    "mandatory": {
      "title": "Mandatory Arguments",
      "description": "These options MUST be provided to run the pipeline:",
      "arguments": {
        "outdir": {
          "type": "string",
          "format": "directory-path",
          "description": "Path to the output directory where the results will be saved.",
          "optional": false
        },
        "out_prefix": {
          "type": "string",
          "description": "Prefix for output files and/or directories.",
          "optional": false
        },
        "pipeline": {
          "type": "string",
          "description": "Specification of which sub-workflow to run.",
          "valid": [
            "qc", "assembly", "assembly_assessment", "alignment", 
            "variant", "psmc", "orthofinder", "codeml",
            "hyphy", "hyphy_analyses"
          ],
          "optional": false
        }
      }
    },
    "nf_arguments": {
      "title": "Nextflow Arguments",
      "description": [
        "These are recommended Nextflow-specific arguments relating to the", 
        "execution of Nextflow itself. Notice the use of single hyphens when",
        "calling these arguments!"
      ],
      "arguments": {
        "profile": {
          "type": "string",
          "description": "Which pipeline profiles to use to execute the pipeline.",
          "valid": ["standard", "phoenix", "afw", "gadi", "conda"],
          "optional": false
        },
        "resume": {
          "type": "boolean",
          "description": "Should the workflow be resumed.",
          "optional": true
        },
        "work-dir": {
          "type": "string",
          "description": "Working directory name.",
          "optional": false
        },
        "with-notification": {
          "type": "string",
          "description": "Email to send a workflow execution email to - success/failure notification.",
          "optional": true
        }
      }
    },
    "cluster": {
      "title": "Cluster Arguments",
      "description": "Arguments for running jobs on HPC clusters (ignore if '-profile standard'):",
      "arguments": {
        "partition": {
          "type": "string",
          "description": "Which job-queue to submit to submit jobs to.",
          "valid": {
            "phoenix": ["skylake", "skylakehm", "test"],
            "gadi": [ "normal" ],
            "afw": [ "afw" ],
            "standard": [ false ]
          },
          "optional": true
        },
        "max_memory": {
          "type": "memoryUnit",
          "description": "Maximum amount of memory that can be requested. DO NOT TOUCH.",
          "optional": true
        },
        "max_cpus": {
          "type": "integer",
          "description": "Maximum number of CPUs that can be requested. DO NOT TOUCH.",
          "optional": true
        },
        "max_time": {
          "type": "duration",
          "description": "Maximum amount of time that can be requested. DO NOT TOUCH.",
          "optional": true
        }
      }
    },
    "qc": {
      "title": "QC pipeline Arguments",
      "description": "Short-read quality control pipeline arguments.",
      "arguments": {
        "seqdir": {
          "type": "string",
          "format": "directory-path",
          "pattern":"*_R{1,2}.{fastq,fq}.gz",
          "nfiles": -1,
          "description": "Directory path containing paired-end short-read FASTQ files.",
          "optional": false
        },
        "platform": {
          "type": "string",
          "description": "Specify the sequencing platform.",
          "valid": [[ "illumina", "mgi" ], "single"],
          "optional": false
        },
        "krakendb": {
          "type": "string",
          "format": "directory-path",
          "description": "Directory path to pre-installed Kraken2 database.",
          "optional": false
        },
        "bq_phred": {
          "type": "integer",
          "description": "Quality value that a base is qualified. Default phread quality >= 15.",
          "optional": true
        },
        "n_base_limit": {
          "type": "integer",
          "description": "Number of N's in a read before read-pair is removed. Default is 5",
          "optional": true
        },
        "average_qual": {
          "type": "integer",
          "description": "Average quality required by a read to not be filtered out. Default 0 (no minimum avg. quality).",
          "optional": true
        },
        "length_required": {
          "type": "integer",
          "description": "Reads shorter than this length will be discarded. Default is 15.",
          "optional": true
        }
      }
    },
    "assembly": {
      "title": "Assembly pipeline options",
      "description": "Genome assembly pipeline arguments.",
      "arguments": {
        "hifi": {
          "type": "string",
          "format": "directory-path",
          "pattern": "*.{fastq,fq}.gz",
          "nfiles": 1,
          "description": "Directory path containing the HiFi fastq file/s.",
          "optional": false
        },
        "assembly": {
          "type": "string",
          "description": "Which genome assembly output to analyses.",
          "valid": [[ "primary", "haplotype1", "haplotype2", "haplotypes", "all" ], "single"],
          "optional": false
        },
        "hic": {
          "type": "string",
          "format": "directory-path",
          "pattern": "*_R{1,2}.{fastq,fq}.gz",
          "nfiles": 2,
          "description": "Directory path containing the Hi-C fastq files.",
          "optional": true
        },
        "scaffolder": {
          "type": "string",
          "description": "Which scaffolding software to use",
          "valid": [[ "pin_hic", "salsa2", "all" ], "single"],
          "optional": false
        },
        "busco_db": {
          "type": "string",
          "description": "Directory path to a pre-downloaded BUSCO database.",
          "optional": false
        }
      }
    },
    "assembly_assessment": {
      "title": "Assembly assessment options ",
      "description": "Genome assembly assessment arguments.",
      "arguments": {
        "reviewed_assembly": {
          "type": "string",
          "format": "directory-path",
          "pattern": "*.review.assembly",
          "nfiles": 1,
          "description": "Directory path containing the Juicebox-edited assembly files (should contain '<id>.review.assembly' files).",
          "optional": false
        },
        "contig": {
          "type": "string",
          "format": "directory-path",
          "pattern": "*.fa",
          "nfiles": 1,
          "description": "Directory path containing the Hifiasm contig output as generated by the 'assembly' pipeline.",
          "optional": false
        },
        "filtered_hifi": {
          "type": "string",
          "format": "directory-path",
          "pattern": "*.fast?.gz",
          "nfiles": 1,
          "description": "Directory path to adapter-filtered HiFi sequence data generated by the 'assembly' pipeline",
          "optional": false
        },
        "assembly": {
          "type": "string",
          "description": "Which genome assembly output to analyses.",
          "valid": [[ "primary", "haplotype1", "haplotype2", "haplotypes", "all" ], "single"],
          "optional": false
        },
        "length": {
          "type": "integer",
          "description": "Filter scaffolds less than this length.",
          "optional": true
        },
        "busco_db": {
          "type": "string",
          "description": "Directory path to a pre-downloaded BUSCO database.",
          "optional": true
        }
      }
    },
    "alignment": {
      "title": "Alignment options",
      "description": "Short-read alignment arguments.",
      "arguments": {
        "seqdir": {
          "type": "string",
          "format": "directory-path",
          "pattern": "*_R{1,2}.{fastq,fq}.gz",
          "nfiles": 2,
          "description": "Directory path to paired-end reads.",
          "optional": false
        },
        "sheet": {
          "type": "string",
          "format": "file-path",
          "description": "CSV file of two columns '<sample.basename>,<reference>'.",
          "optional": false
        },
        "platform": {
          "type": "string",
          "description": "Specify the sequencing platform.",
          "valid": [[ "illumina", "mgi" ], "single"],
          "optional": false
        },
        "aligner": {
          "type": "string",
          "description": "Aligner to use for short-read mapping.",
          "valid": [ [ "bwa2", "minimap2" ], "single" ],
          "optional": false
        },
        "mapq": {
          "type": "integer",
          "description": "Minimum mapping quality threshold. Default 10.",
          "optional": true
        }
      }
    },
    "variant": {
      "title": "Variant calling options",
      "description": "Variant calling pipeline arguments.",
      "arguments": {
        "sheet": {
          "type": "string",
          "format": "file-path",
          "description": "CSV file with paths to each BAM and its corresponding reference genome: '<path BAM>,<path reference>'",
          "optional": false
        },
        "method": {
          "type": "string",
          "description": "Method of variant calling.",
          "valid": [ ["standard", "joint"], "single" ],
          "optional": false
        },
        "caller": {
          "type": "string",
          "description": "Which BCFtools calling method to use: new (-m) or old (-c). Use old for PSMC!",
          "valid": [ [ "new", "old" ], "single" ],
          "optional": false
        },
        "vcftype": {
          "type": "string",
          "description": "Type of VCF to return.",
          "valid": [ [ "variant", "allsites" ] , "single" ],
          "optional": false
        },
        "regions": {
          "type": "string",
          "format": "directory-path",
          "pattern": "*.bed",
          "nfiles": 1,
          "description": "Directory path to region files (BED format) to call variants in. The basename of the file should match the reference it is to be used for.",
          "optional": true
        },
        "force": {
          "type": "boolean",
          "description": "Force the re-creation of internal intermediate files (bamlist, BED-regions) rather than using a previous runs versions.",
          "optional": true
        },
        "nodp": {
          "type": "boolean",
          "description": "Don't apply depth filter (only applies to 'standard' mode)",
          "optional": true
        },
        "mapq": {
          "type": "integer",
          "description": "Mapping quality applied at 'mpileup'. Default: 10.",
          "optional": true
        },
        "baseq": {
          "type": "integer",
          "description": "Base quality applied at 'mpileup'. Default: 10.",
          "optional": true
        },
        "genoq": {
          "type": "integer",
          "description": "Genotype-quality filter.",
          "optional": true
        },
        "ploidy": {
          "type": "integer",
          "description": "Ploidy of the organism. Default: 2",
          "optional": true
        },
        "mpileup_opt": {
          "type": "string",
          "description": "Optional arguments to pass to 'bcftools mpileup'. Provide within single quotes.",
          "optional": true
        },
        "call_opt": {
          "type": "string",
          "description": "Optional arguments to pass to 'bcftools call'. Provide within single quotes.",
          "optional": true
        },
        "filter_opt": {
          "type": "string",
          "description": "Optional arguments to pass to 'bcftools filter'. Provide within single quotes.",
          "optional": true
        },
        "view_opt": {
          "type": "string",
          "description": "Optional arguments to pass to 'bcftools view'. Provide within single quotes.",
          "optional": true
        },
        "norm_opt": {
          "type": "string",
          "description": "Optional arguments to pass to 'bcftools norm'. Provide within single quotes.",
          "optional": true
        },
        "sort_opt": {
          "type": "string",
          "description": "Optional arguments to pass to 'bcftools sort'. Provide within single quotes.",
          "optional": true
        }
      }
    },
    "consensus": {
      "title": "Consensus options",
      "description": "Consensus pipeline arguments.",
      "arguments": {
        "bamdir": {
          "type": "string",
          "format": "directory-path",
          "pattern": "*.bam",
          "nfiles": 1,
          "description": "Directory path to BAM files.",
          "optional": false
        },
        "sheet": {
          "type": "string",
          "format": "file-path",
          "description": "CSV file of two columns '<bam.basename>,<reference>'.",
          "optional": false
        },
        "mapq": {
          "type": "integer",
          "description": "Mapping quality applied at 'mpileup'. Default: 10.",
          "optional": true
        },
        "baseq": {
          "type": "integer",
          "description": "Base quality applied at 'mpileup'. Default: 10.",
          "optional": true
        },
        "ploidy": {
          "type": "integer",
          "description": "Ploidy of the organism. Default: 2",
          "optional": true
        },
        "mpileup_opt": {
          "type": "string",
          "description": "Optional arguments to pass to 'bcftools filter'. Provide within single quotes.",
          "optional": true
        },
        "call_opt": {
          "type": "string",
          "description": "Optional arguments to pass to 'bcftools filter'. Provide within single quotes.",
          "optional": true
        },
        "filter_opt": {
          "type": "string",
          "description": "Optional arguments to pass to 'bcftools filter'. Default: '--SnpGap 10'.",
          "optional": true
        },
        "view_opt": {
          "type": "string",
          "description": "Optional arguments to pass to 'bcftools view'. Default: '--exclude-types indels'.",
          "optional": true
        },
        "norm_opt": {
          "type": "string",
          "description": "Optional arguments to pass to 'bcftools norm'. Default: '-m +any'.",
          "optional": true
        },
        "sort_opt": {
          "type": "string",
          "description": "Optional arguments to pass to 'bcftools sort'. Provide within single quotes.",
          "optional": true
        },
        "consensus_opt": {
          "type": "string",
          "description": "Optional arguments to pass to 'bcftools consensus'. Default: '-H 1'.",
          "optional": true
        }
      }
    },
    "orthofinder": {
      "title": "OrthoFinder ortholog options",
      "description": "Pipeline to detect orthologs using Orthofinder",
      "arguments": {
        "gffs": {
          "type": "string",
          "format": "directory-path",
          "pattern": "*.{gff,gff3}",
          "nfiles": 1,
          "description": "Directory path to annotation files. Extension must be '.gff' or '.gff3'.",
          "optional": false
        },
        "genomes": {
          "type": "string",
          "format": "directory-path",
          "pattern": "*.{fa,fasta,fna}",
          "nfiles": 1,
          "description": "Directory path to genome assembly files. Extension must be '.fa', '.fasta' or '.fna'.",
          "optional": false
        },
        "tree": {
          "type": "string",
          "format": "file-path",
          "description": "File path to phylogenetic tree that OrhtoFinder should use.",
          "optional": true
        },
        "search_prog": {
          "type": "string",
          "description": "Which sequence search program OrthoFinder should use.",
          "valid": [ ["blast", "diamond", "diamond_ultra_sens", "blast_gz", "mmseqs", "blast_nucl"], "single" ],
          "optional": false
        },
        "trim_msa": {
          "type": "boolean",
          "description": "Should OrthoFinder trim multiple sequence alignments?",
          "optional": true
        },
        "stop_early": {
          "type": "boolean",
          "description": "Stop OrthoFinder after generating MSA files. Running the full pipeline can take a LONG time.",
          "optional": true
        }
      }
    },
    "codeml": {
      "title": "CodeML pipeline options",
      "description": "CodeML pipeline specific arguments:",
      "arguments": {
        "msa": {
          "type": "string",
          "format": "directory-path",
          "pattern": "*.{fa,fasta}",
          "nfiles": 1,
          "description": "Directory path to MSA files. Extension must be '.fa' or '.fasta'.",
          "optional": false
        },
        "tree": {
          "type": "string",
          "format": "file-path",
          "description": "File path to phylogenetic tree.",
          "optional": false
        },
        "models": {
          "type": "string",
          "description": "Which CodeML models to run. Provide as a quoted string separated by spaces.",
          "valid": [ [ "M0","M1","M2","M3","M4","M5","M6","M7","M8","M8a","M9",
                     "M10","M11","M12","M13","SLR","fb_anc","bsA","bsA1","bsB",
                     "bsC","bsD","b_free","b_neut","fb"], "multiple" ],
          "optional": false
        },
        "dropout": {
          "type": "boolean",
          "description": "Run drop-out analysis if BS models are run. Only works if you are running bsA AND bsA1.",
          "optional": true
        }
      }
    },
    "hyphy": {
      "title": "HyPhy pipeline options",
      "description": "HyPhy specific options",
      "arguments": {
        "msa": {
          "type": "string",
          "format": "directory-path",
          "pattern": "*.{fa,fasta}",
          "nfiles": 1,
          "description": "Directory path to MSA files. Extension must be '.fa' or '.fasta'.",
          "optional": false
        },
        "tree": {
          "type": "string",
          "format": "file-path",
          "description": "File path to phylogenetic tree with 'test' branches marked using '{}' notation. E.g. (sample1, sample2{Test});.",
          "optional": false
        },
        "testLabel": {
          "type": "string",
          "description": "What is the branch label ('{}') listed in the tree file.",
          "optional": false
        },
        "analysis": {
          "type": "string",
          "description": "Which HyPhy analysis/analyses to run.",
          "valid": [ [ "RELAX" ], "single" ],
          "optional": false
        }
      }
    },
    "hyphy_analyses": {
      "title": "HyPhy Analyses pipeline options",
      "description": "HyPhy analyses specific options",
      "arguments": {
        "msa": {
          "type": "string",
          "format": "directory-path",
          "pattern": "*.{fa,fasta}",
          "nfiles": 1,
          "description": "Directory path to MSA files. Extension must be '.fa' or '.fasta'.",
          "optional": false
        },
        "tree": {
          "type": "string",
          "format": "file-path",
          "description": "File path to phylogenetic tree with 'test' branches marked using '{}' notation. E.g. (sample1, sample2{Test});.",
          "optional": false
        },
        "testLabel": {
          "type": "string",
          "description": "What is the branch label ('{}') listed in the tree file.",
          "optional": false
        },
        "batchFile": {
          "type": "string",
          "description": "Which 'HyPhy analysis' batch file to run",
          "valid": [ [ "BUSTED-PH.bf" ], "single" ],
          "optional": false
        },
        "hyphyDev": {
          "type":"string",
          "description": "Absolute directory path to HyPhy 'develop' directory. This has to be installed via git!",
          "optional": false
        },
        "hyphyAnalysis": {
          "type":"string",
          "description": "Absolute directory path to 'hyphy-analyses' directory. This has to be installed via git!",
          "optional": false
        }
      }
    },
    "psmc": {
      "title": "PSMC pipeline options",
      "description": "PSMC pipeline arguments:",
      "arguments": {
        "filedir": {
          "type": "string",
          "description": "Directory path to VCF files.",
          "format": "directory-path",
          "pattern": "**{vcf.gz,bam}",
          "nfiles": 1,
          "optional": false
        },
        "filetype": {
          "type": "string",
          "description": "Type of input file. VCF files must be created with the old SAMtools/BCFtools calling algorithm (-c).",
          "valid": [ [ "vcf", "bam"], "single" ],
          "optional": false
        },
        "clock": {
          "type": "string",
          "description": "Molecular clocks to use when running PSMC. Separate multiple clocks using a single white space.",
          "optional": false
        },
        "bootstrap": {
          "type": "boolean",
          "description": "Whether to generate bootstrap support",
          "optional": true
        },
        "minMQ": {
          "type": "integer",
          "description": "Minimum mapping quality value to consider when generating the consensus sequence.",
          "optional": false
        },
        "regions": {
          "type": "string",
          "format": "file-path",
          "description": "File path to CSV that pairs region BED files to samples: <sample.basename>,<bed.path>.",
          "optional": true
        }
      }
    }
  }
}
